<h1 data-heading="Chapter 2:">Chapter 2:</h1>
<ul>
<li>Joining Windows and Parrot OS</li>
<li>Resource and Package Management</li>
<li>Some Absurdist Parsing Practice</li>
</ul>
<h5 data-heading="*October 2nd, 2023*"><em>October 2nd, 2023</em></h5>
<hr>
<h2 data-heading="Client Setup, Joining the Domain">Client Setup, Joining the Domain</h2>
<p>In the previous chapter I had decided to work on hardening next, but I decided to further flesh out my home lab and check out some more options. I'm certainly going to do hardening in a chapter soon, but I'd like to expand my infrastructure some more and see about some other experiments. </p>
<p>You'll notice that the structure, objectives, and content will likely change from chapter to chapter. I like the idea of writing in the form of journal entries for now. I appreciate your interest while I find my stride.</p>
<p>As I'm sure you noticed in Chapter 1, my markdown aesthetic could use some work, so I'll try to buff that out over time.</p>
<p></p><div src="a/184e90a547dade68d4ca7f0cdb54b79e.png" class="internal-embed"></div><p></p>
<p align="center">
    <img alt="serversetup" src="./a/serversetup.png" referrerpolicy="no-referrer">
</p>
*I created a Windows Server 2019 box to use as a client (ironic) without a desktop environment to save on host resources, and to force myself to use more Powershell (though to be honest I really like the CLI). I then configured the local network adapter as shown above.*
![](a/e264def1d2bcb414636814b50893f023.png)
<p align="center">
    <img src="./a/dnsconfig.png" referrerpolicy="no-referrer">
</p>
*Next I configured the DNS setting on my client and tested it with ping.*
![](a/9b8fb703e8235a82b613bb4e137fb0e0.png)
<p align="center">
    <img alt="abcde admin" src="./a/abcdeabercrombie.png" referrerpolicy="no-referrer">
</p>
*Here I bounced over to the DC to create a non-default administrator account for our fictional Admin, Abcde Abercrombie since I hadn't done so yet.*
``` powershell
PS C:\Users\Administrator&gt; $password = Read-Host -AsSecureString
***********************************************************************
PS C:\Users\Administrator&gt; echo $password
System.Security.SecureString
PS C:\Users\Administrator&gt; Set-ADAccountPassword -Identity "Abcde.Abercrombie" -NewPassword $password
```
*I set Abcde's password using a secure string.*
![](a/7ed8db8aa8c9c03579e9d5d536a33f6e.png)
<p align="center">
    <img src="./a/addclienttoad.png" referrerpolicy="no-referrer">
</p>
*I joined Abcde's client to the domain.*
``` powershell
PS C:\Users\Administrator&gt; Restart-Computer
```
![](a/028754865d3813b68ac35d496cedb21d.png)
<p align="center">
    <img src="./a/abcdesignin.png" referrerpolicy="no-referrer">
</p>
*Finally, I restarted the computer and logged in to the domain account.*
## Parrot OS Setup, and Resource Management
<p></p><div src="a/ad0ec62809f143a96cb7efd2c0650f64.png" class="internal-embed"></div><p></p>
<p>I imported a Parrot .ova, but it hung my computer, so I had to press <code>Alt+Ctrl+F1'</code> to switch to another tty. Luckily I was able to log in and kill the Parrot vm in the other tty so that I didn't need to resort to the <code>SysRq</code> key or perform a hard reboot. This time I'll be installing the core version of Parrot so that I can further save on resources. I might even use security templates later or my backup of the DC to remove that GUI too. </p>
<p>While having limited resources (8 gigs RAM, 128 gigs storage, and an i5) might seem tedious, it's helping me to foster frugality in my resource management habits and learn how to operate with the bare necessities and built-in functionality. In addition, it's forcing me to build things in a more manual fashion. I'm running all of this on a Debian host which started with no display manager, desktop environment, or gui applications. I've been installing lightweight packages when absolutely necessary with a preference for CLI and fewer dependencies. I also configured awesomewm for productivity and riced it. </p>
<p></p><div src="a/20135a8aa14347394d91386d66378f58.png" class="internal-embed"></div><p></p>
<p>I'll reinstall a parrot "architect" vm and start from scratch. I'll install a DE and anything else I need from the parrot repo's and I'll only keep packages for as long as I'm using them. This type of behavior also forces me to figure out how to hold on to and manipulate configuration files for various applications in case I need to install them again later. I won't do any ricing this time, even though its extremely conducive to my <del>procrastination</del> productivity.</p>
<p></p><div src="a/95442e67997877bd5f9db19724b8c187.png" class="internal-embed"></div><p></p>
<p></p><div src="a/b1f7ea601c6bddabcee98d2b4bb5e3fc.png" class="internal-embed"></div><br>
<div src="a/1cdf175a17bb2817c4c65e97a8522158.png" class="internal-embed"></div><br>
<em>Something about a fresh distro is like a new car smell! Looks like parrot starts with its network adapters turned off? Convenient for stealth I suppose. I chose to install LXQt since it's lightweight, I haven't tried it before, and it was in the Parrot repo for easy access. I'm hoping it comes with a display manager. If not, I might try out Xstart.</em> <p></p>
<p></p><div src="a/27e130907291da6aa87019b1734909c6.png" class="internal-embed"></div><br>
<div src="a/67276d60c21fc24fea88a1f8d00cdaef.png" class="internal-embed"></div><br>
<em>I'm in luck! It came with a display manager. After I logged in, I realized that I had also installed a bunch of suggested packages without thinking about it. I'll go through and clean them out super quick.</em><p></p>
<h1 data-heading="Some Parsing Fun">Some Parsing Fun</h1>
<p></p><div src="a/e1810744069a56048879fe71904a8651.png" class="internal-embed"></div><br>
<div src="a/daea0297eeadf15e47f5bb1233c6994f.png" class="internal-embed"></div><br>
<em>It wasn't so quick! I ended up practicing some bash parsing skills. On the way, I decided I wanted to test whether or not github flavored markdown has a code block coloring format for bash... or even the fancy 2 line prompt. In the process I realized that my clipboard wasn't working. I decided to use netcat to send the data to my host machine instead. In the end, the markdown couldn't highlight it:</em><p></p>
<pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">┌─<span class="token punctuation">[</span>parrot@parrot<span class="token punctuation">]</span>─<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└──╼ <span class="token variable">$cat</span> /var/log/apt/history.log <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"install lxqt"</span> -A <span class="token number">2</span> <span class="token operator">|</span> <span class="token function">tail</span> -n <span class="token number">1</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/([^)]*)//g'</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/\:amd64//g'</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/\s,//g'</span> <span class="token operator">&gt;</span> Desktop/extrapacks
</code><button class="copy-code-button">Copy</button></pre>
<p></p><div src="a/240eeb0a96a0045cf28a1d42df97ea15.png" class="internal-embed"></div><br>
<div src="a/7261ae118162124ea4863d587923fc31.png" class="internal-embed"></div><br>
<em>There were quite a few extra records! I'll just look through the list instead and get rid of ones that pop out...</em><br>
<div src="a/f77aa30a27c7018f07f8b162724e95f5.png" class="internal-embed"></div><p></p>
<h1 data-heading="Installing `lxqt-core` with `lightdm` Instead">Installing <code>lxqt-core</code> with <code>lightdm</code> Instead</h1>
<h5 data-heading="On second thought, it was much easier to purge the entire desktop environment and reinstall rather than investigate packages line-by-line, so that's what I did. I'm as set up as I'm going to get for now without spending too much time getting side tracked. Tomorrow I'm going to look into setting up Suricata, Splunk, and maybe I'll even have time to attempt detecting a few Metasploit exploits!">On second thought, it was much easier to purge the entire desktop environment and reinstall rather than investigate packages line-by-line, so that's what I did. I'm as set up as I'm going to get for now without spending too much time getting side tracked. Tomorrow I'm going to look into setting up Suricata, Splunk, and maybe I'll even have time to attempt detecting a few Metasploit exploits!</h5>